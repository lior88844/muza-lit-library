import{u as B,w as z,a as O}from"./musicStore--JzGZpRB.js";import{o as e,a as l,M as K,L as C,S as q,p as G,O as H,q as Q}from"./chunk-DQRVZFIR-BNfO-z-U.js";import{G as _,F as W,a as Y,b as J,c as Z,d as V,e as U,L as ee}from"./index-D2b-e064.js";import{M as se,a as te}from"./MusicTopbar-BG-qa0U7.js";import{u as A}from"./currentPlayerStore-gocPPhXU.js";/* empty css                      */import"./MuzaIcon-C5IYoGjN.js";/* empty css                    */const P={defaultMode:"auto",localStorageKey:"flowbite-theme-mode",prefix:""};function X({mode:s,defaultMode:a=P.defaultMode,localStorageKey:o=P.localStorageKey,...r}){return e.jsx("script",{...r,"data-flowbite-theme-mode-script":!0,dangerouslySetInnerHTML:{__html:re({mode:s,defaultMode:a,localStorageKey:o,prefix:""})}})}X.displayName="ThemeModeScript";function re(s={}){const{mode:a,defaultMode:o=P.defaultMode,localStorageKey:r=P.localStorageKey,prefix:n=P.prefix}=s;return`
    try {
      const storageMode = window.localStorage.getItem("${r}");
      const isStorageModeValid = storageMode === "light" || storageMode === "dark" || storageMode === "auto";
      const resolvedMode = (isStorageModeValid ? storageMode : null) ?? ${a?`"${a}"`:void 0} ?? "${o}";
      const computedMode =
        resolvedMode === "auto" ? (window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light") : resolvedMode;

      if (computedMode === "dark") {
        document.documentElement.classList.add("${n}dark");
      } else {
        document.documentElement.classList.remove("${n}dark");
      }
      localStorage.setItem("${r}", resolvedMode);

      // Add listener for system theme changes
      const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
      mediaQuery.addEventListener("change", (e) => {
        const storageMode = window.localStorage.getItem("${r}");
        const isStorageModeValid = storageMode === "light" || storageMode === "dark" || storageMode === "auto";
        const resolvedMode = isStorageModeValid ? storageMode : "${o}";

        if (resolvedMode === "auto") {
          if (e.matches) {
            document.documentElement.classList.add("${n}dark");
          } else {
            document.documentElement.classList.remove("${n}dark");
          }
        }
      });

      // Add listener for storage changes
      window.addEventListener("storage", (e) => {
        if (e.key === "${r}") {
          const newMode = e.newValue;
          const isStorageModeValid = newMode === "light" || newMode === "dark" || newMode === "auto";
          const resolvedMode = isStorageModeValid ? newMode : "${o}";

          if (resolvedMode === "dark" || (resolvedMode === "auto" && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
            document.documentElement.classList.add("${n}dark");
          } else {
            document.documentElement.classList.remove("${n}dark");
          }
        }
      });
    } catch (e) {}
  `}function ne(s){return _({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96l160 0 0 32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32l0 32L160 64C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96l-160 0 0-32c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6l0-32 160 0c88.4 0 160-71.6 160-160z"},child:[]}]})(s)}const ae=({value:s=75,muted:a=!1,disabled:o=!1,volumeStep:r=1,onVolumeChange:n,noSymbol:f=!1})=>{const[u,m]=l.useState(a),[i,d]=l.useState(!1),M=l.useRef(s),x=l.useRef(null),y=()=>{o||(u?(m(!1),n==null||n(M.current)):(M.current=s,m(!0),n==null||n(0)))},v=()=>u||s===0?"volume-mute":s<50?"volume-down":"volume-up",w=j=>{if(o||!x.current)return;const S=x.current.getBoundingClientRect(),g=8,p=g,L=S.width-g,t=(Math.max(p,Math.min(L,j.clientX-S.left))-p)/(L-p)*100,h=Math.round(t/r)*r;m(!1),n==null||n(h)},c=j=>{if(!i||!x.current||o)return;const S=x.current.getBoundingClientRect(),g=8,p=g,L=S.width-g,t=(Math.max(p,Math.min(L,j.clientX-S.left))-p)/(L-p)*100,h=Math.round(t/r)*r;n==null||n(h)},E=()=>{o||d(!0)},N=()=>{d(!1)};l.useEffect(()=>(i?(window.addEventListener("mousemove",c),window.addEventListener("mouseup",N)):(window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",N)),()=>{window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",N)}),[i]);const $=j=>8+j*84/100;return e.jsxs("div",{className:`volume-control ${o?"disabled":""}`,children:[!f&&e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-speaker volume-icon",onClick:y}),e.jsx("i",{className:`fa-solid fa-${v()} volume-icon`,onClick:y})]}),e.jsx("div",{className:"slider",ref:x,onClick:w,children:e.jsxs("svg",{viewBox:"0 0 100 24",children:[e.jsx("line",{className:"track",x1:"2",y1:"12",x2:"98",y2:"12"}),e.jsx("line",{className:"fill",x1:"2",y1:"12",x2:$(s),y2:"12"}),e.jsx("circle",{className:"handle",cx:$(s),cy:"12",r:"8",onMouseDown:E})]})})]})},oe=({details:s,onPrevious:a,onNext:o,onUpdate:r,onSongEnded:n,setIsPlaying:f})=>{const u=l.useRef(null),[m,i]=l.useState(0),[d,M]=l.useState(0),[x,y]=l.useState(75),[v,w]=l.useState(!1),[c,E]=l.useState(!1),[N,$]=l.useState(!1),j=t=>{const h=Math.floor(t/60),k=Math.floor(t%60).toString().padStart(2,"0");return`${h}:${k}`},S=m>0?d/m*100:0,g=()=>{const t=u.current;t&&t.play().catch(h=>{console.error("Error playing audio:",h),f(!1),r==null||r({...s})})},p=t=>{y(t),u.current&&(u.current.volume=t/100)},L=t=>{const h=u.current;if(!h||m===0)return;const k=t.currentTarget.getBoundingClientRect(),b=(t.clientX-k.left)/k.width*m;h.currentTime=b,M(b)},T=()=>{if(v)return;const t=!s.isPlaying;f(t),r==null||r({...s})};return l.useEffect(()=>{f(s.isPlaying||!1)},[s.isPlaying]),l.useEffect(()=>{const t=u.current;t&&(s.isPlaying&&!v?g():s.isPlaying||t.pause())},[s.isPlaying,v]),l.useEffect(()=>{const t=u.current;if(!t||!s.audioUrl)return;const h=()=>{i(t.duration),w(!1),s.isPlaying&&g()},k=()=>M(t.currentTime),F=()=>{f(!1),r==null||r({...s}),n==null||n()},b=()=>{f(!0),r==null||r({...s})},D=()=>{f(!1),r==null||r({...s})},R=()=>w(!0),I=()=>w(!1);return t.addEventListener("loadeddata",h),t.addEventListener("timeupdate",k),t.addEventListener("ended",F),t.addEventListener("play",b),t.addEventListener("pause",D),t.addEventListener("loadstart",R),t.addEventListener("waiting",R),t.addEventListener("canplay",I),t.src=s.audioUrl,t.volume=x/100,t.load(),s.isPlaying&&g(),()=>{t.pause(),t.removeEventListener("loadeddata",h),t.removeEventListener("timeupdate",k),t.removeEventListener("ended",F),t.removeEventListener("play",b),t.removeEventListener("pause",D),t.removeEventListener("loadstart",R),t.removeEventListener("waiting",R),t.removeEventListener("canplay",I)}},[s.audioUrl]),e.jsxs("div",{className:"music-player",children:[e.jsx("audio",{ref:u,hidden:!0}),e.jsxs("div",{className:"player-info",children:[e.jsx("img",{className:"album-art",src:s.imageSrc,alt:`${s.title} album cover`}),e.jsxs("div",{className:"track-info",children:[e.jsx("h2",{className:"track-title",children:s.title}),e.jsx("p",{className:"track-artist",children:s.artist}),e.jsxs("div",{className:"track-details",children:[e.jsx("span",{children:s.album}),e.jsx("span",{className:"separator",children:"â€¢"}),e.jsx("span",{children:s.year})]})]})]}),e.jsxs("div",{className:"player-controls",children:[e.jsxs("div",{className:"progress-section",children:[e.jsx("div",{className:"progress-bar",onClick:L,children:e.jsx("div",{className:"progress-fill",style:{width:`${S}%`}})}),e.jsxs("div",{className:"time-display",children:[e.jsx("span",{children:j(d)}),e.jsx("span",{children:j(m-d)})]})]}),e.jsxs("div",{className:"controls-row",children:[e.jsxs("div",{className:"playback-controls",children:[e.jsx("button",{className:`control-btn shuffle ${c?"active":""}`,onClick:()=>E(!c),"aria-label":"Shuffle",children:e.jsx(W,{})}),e.jsx("button",{className:"control-btn previous",onClick:a,"aria-label":"Previous track",children:e.jsx(Y,{})}),e.jsx("button",{className:"control-btn play",onClick:T,"aria-label":"Play or pause",children:v?e.jsx(J,{className:"spinner"}):s.isPlaying?e.jsx(Z,{}):e.jsx(V,{})}),e.jsx("button",{className:"control-btn next",onClick:o,"aria-label":"Next track",children:e.jsx(U,{})}),e.jsx("button",{className:`control-btn repeat ${N?"active":""}`,onClick:()=>$(!N),"aria-label":"Repeat",children:e.jsx(ne,{})})]}),e.jsx("div",{className:"volume-section",children:e.jsx(ae,{noSymbol:!0,value:x,onVolumeChange:p})})]})]})]})};function ce(){const{recentlyPlayed:s}=B(),{selectedSong:a,setSelectedSong:o,isPlaying:r,setIsPlaying:n}=A(),f=()=>!a||!a.id?-1:s.findIndex(i=>i.id===a.id),u=()=>{const i=f();let d;i<=0?d=s[s.length-1]:d=s[i-1],o({...d})},m=()=>{const i=f();let d;i===-1||i===s.length-1?d=s[0]:d=s[i+1],o({...d})};return e.jsx(e.Fragment,{children:a&&e.jsx(oe,{details:{audioUrl:a.audioUrl||"",imageSrc:a.imageSrc||"",title:a.title,artist:a.artist||"",album:a.album||"",year:a.year||new Date().getFullYear(),isPlaying:r||!1,id:a.id},setIsPlaying:n,onUpdate:i=>{o({...a,audioUrl:i.audioUrl})},onPrevious:u,onNext:m,onSongEnded:m})})}const ge=()=>[{rel:"preconnect",href:"https://fonts.googleapis.com"},{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"},{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"},{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"}];function pe({children:s}){const{sidebarSections:a,setNewReleases:o,setFeatured:r,setArtists:n,setRecommended:f,setRecentlyPlayed:u,setSidebarSections:m}=B(),{selectedSong:i,setSelectedSong:d}=A(),[M,x]=l.useState(!0),[y,v]=l.useState(null);l.useEffect(()=>{fetch("/staticData/allData.json").then(c=>{if(!c.ok)fetch("./staticData/allData.json").then(E=>{if(!E.ok)throw new Error("Network response was not ok");return E.json()});else return c.json()}).then(c=>{r(c.albums.featured||[]),o(c.albums.newReleases.slice(0,5)||[]),f(c.albums.recommended||[]),n(c.artists),u(c.songs),m(c.sidebar.sections),c.songs.length>0&&!i&&d(c.songs[0]),x(!1)}).catch(c=>{v(c.message),x(!1)})},[]);const w=M?e.jsx("p",{children:"Loading..."}):y?e.jsxs("p",{children:["Error: ",y]}):null;return e.jsxs("html",{lang:"en",suppressHydrationWarning:!0,children:[e.jsxs("head",{children:[e.jsx("meta",{charSet:"utf-8"}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),e.jsx(K,{}),e.jsx(C,{}),e.jsx(X,{})]}),e.jsxs("body",{children:[e.jsxs("div",{className:"body",children:[e.jsx(se,{logoSrc:"/app/icons/icons/muza.svg",logoAlt:"Music Library",sections:a}),e.jsxs("div",{className:"content",children:[e.jsx(te,{}),w||s,e.jsx(ce,{})]})]}),e.jsx(q,{}),e.jsx(G,{})]}),e.jsx(ee,{})]})}const ve=z(function(){return e.jsx(H,{})}),je=O(function({error:a}){let o="Oops!",r="An unexpected error occurred.",n;return Q(a)&&(o=a.status===404?"404":"Error",r=a.status===404?"The requested page could not be found.":a.statusText||r),e.jsxs("main",{className:"container mx-auto p-4 pt-16",children:[e.jsx("h1",{children:o}),e.jsx("p",{children:r}),n]})});export{je as ErrorBoundary,pe as Layout,ve as default,ge as links};
